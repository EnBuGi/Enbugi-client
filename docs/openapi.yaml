openapi: 3.0.3
info:
  title: En# OJ API
  description: 동아리 스터디 환경 개선을 위한 OJ API 명세서
  version: 1.0.0
  contact:
    name: Github
    email: dev@example.com

servers:
  - url: http://localhost:8080
    description: 로컬 개발 서버

security:
  - BearerAuth: []

  - BearerAuth: []

paths:
  # ---------------- File ----------------
  /api/v1/files/presigned-url:
    post:
      summary: 파일 업로드 URL(Presigned URL) 요청
      description: |
        S3에 파일을 업로드하기 위한 Presigned URL을 발급받습니다.
        `fileType`에 따라 저장 경로와 접근 권한(ACL)이 결정됩니다.
        - `IMAGE`: 문제 설명용 이미지 (Public)
        - `TEST_CODE`: 채점용 테스트 코드 (Private)
      tags:
        - File
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PresignedUrlRequest'
      responses:
        '200':
          description: 발급 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresignedUrlResponse'
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_INVALID_FILE_TYPE"
                message: "지원하지 않는 파일 형식입니다."
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_UNAUTHORIZED"
                message: "인증 토큰이 유효하지 않습니다."
        '403':
          description: 권한 없음 (멘토만 가능)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "파일 업로드 권한이 없습니다."

  # ---------------- Auth ----------------
  /api/v1/auth/login:
    post:
      summary: GitHub 로그인 (및 가입 가능 여부 확인)
      description: |
        GitHub OAuth Code를 제출하여 로그인합니다.
        
        **[로직 흐름]**
        1. **기존 회원**: `code` 제출 → 로그인 성공 (`200 OK`).
        2. **신규 회원**: `code`와 `inviteCode` 제출
           - `inviteCode` 검증 성공 시: `403 Forbidden` + `registerToken` 발급.
           - 클라이언트는 이 토큰을 받아서 `/signup` API로 이동합니다.
      tags:
        - Auth
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: 로그인 성공 (JWT 발급)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: 잘못된 요청 (초대 코드 누락 또는 유효하지 않음)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_INVALID_INVITE_CODE"
                message: "초대 코드가 유효하지 않습니다."
        '401':
          description: 인증 실패 (GitHub 코드 유효하지 않음)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_GITHUB_AUTH_FAILED"
                message: "GitHub 인증에 실패했습니다."
        '403':
          description: |
            가입 필요 (신규 회원, 초대 코드는 유효함).
            Response Body에 가입용 임시 토큰(`registerToken`)과 프로필 정보가 포함됩니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SignupRequiredResponse'

  /api/v1/auth/signup:
    post:
      summary: 회원가입 완료 (Register Token 제출)
      description: |
        `/login`에서 발급받은 `registerToken`과 추가 정보를 제출하여 가입을 완료합니다.
      tags:
        - Auth
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignupRequest'
      responses:
        '200':
          description: 가입 성공 및 로그인 (JWT 발급)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: 잘못된 요청 (필수 정보 누락)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_BAD_REQUEST"
                message: "필수 정보가 누락되었습니다."
        '401':
          description: 토큰 만료 또는 유효하지 않음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_REGISTER_TOKEN_EXPIRED"
                message: "가입 토큰이 만료되었습니다."


  # ---------------- Project (Public) ----------------
  /api/v1/projects:
    get:
      summary: 프로젝트 목록 조회 (멘티/멘토 공용)
      description: |
        **현재 활동 중인 기수**의 프로젝트 목록만 조회합니다. (예: 2026년이면 13기 프로젝트만)
        `status` 필드를 통해 프로젝트 상태(ONGOING, DONE, BEFORE)를 확인할 수 있습니다.
      tags:
        - Project
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectSummaryResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_UNAUTHORIZED"
                message: "인증이 필요합니다."

  /api/v1/projects/{id}:
    get:
      summary: 프로젝트 상세 조회
      description: |
        해당 ID의 프로젝트의 상세 정보를 조회합니다.
        **주의**: `isHidden=true`인 테스트 케이스는 정보가 마스킹되어 반환됩니다. (Postman 조회 시에도 세부 내용 확인 불가)
      tags:
        - Project
      parameters:
        - name: id
          in: path
          required: true
          description: 조회할 프로젝트의 고유 ID (UUID)
          schema:
            type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json: 
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectDetailResponse'
        '400':
          description: 잘못된 요청 (ID 형식 오류)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_INVALID_PROJECT_ID_FORMAT"
                message: "올바르지 않은 프로젝트 ID 형식입니다."
        '401':
          description: 인증 실패 (토큰 없음/만료)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_UNAUTHORIZED"
                message: "인증이 필요합니다."
        '404':
          description: 리소스 없음 (프로젝트 없음)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_PROJECT_NOT_FOUND"
                message: "해당 프로젝트를 찾을 수 없습니다."

  /api/v1/projects/submit:
    post:
      summary: 과제 제출
      description: |
        특정 프로젝트(과제)에 대한 GitHub Repository URL을 제출합니다. (Notion 3-1)
        프로젝트 ID는 Body에 포함하여 요청합니다.
      tags:
        - Project
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitRequest'
      responses:
        '200':
          description: 제출 성공
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_BAD_REQUEST"
                message: "잘못된 요청 형식입니다."
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_UNAUTHORIZED"
                message: "인증이 필요합니다."
        '404':
          description: 리소스 없음 (프로젝트 없음)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_PROJECT_NOT_FOUND"
                message: "해당 프로젝트를 찾을 수 없습니다."
        '409':
          description: 충돌 (채점 진행 중)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_GRADING_IN_PROGRESS"
                message: "현재 채점이 진행 중입니다."

  /api/v1/projects/{projectId}/submissions:
    get:
      summary: 내 제출 이력 조회
      description: 해당 프로젝트에 대한 '내'(로그인한 유저) 모든 제출 이력을 조회합니다.
      tags:
        - Submission
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SubmissionSummaryResponse'
        '401':
          description: 인증 실패

  /api/v1/submissions/{submissionId}:
    get:
      summary: 제출 이력 상세 조회 (내 제출)
      description: |
        내 제출 이력 중 특정 건의 상세 결과를 조회합니다.
        **주의**: `isHidden=true`인 테스트 케이스는 정보가 마스킹되어 반환됩니다.
      tags:
        - Submission
      parameters:
        - name: submissionId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmissionDetailResponse'
        '403':
          description: 권한 없음 (본인 제출이 아님)
        '404':
          description: 제출 기록 없음

  /api/v1/users/me:
    get:
      summary: 내 정보 조회
      description: 현재 로그인한 사용자의 정보를 조회합니다.
      tags:
        - User
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '401':
          description: 인증 실패

    patch:
      summary: 내 정보 수정 (이름, 프로필 이미지 변경)
      description: 현재 로그인한 사용자의 이름(name)이나 프로필 이미지(profileImageUrl)를 변경합니다.
      tags:
        - User
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: "김철수"
                  description: "변경할 이름"
                profileImageUrl:
                  type: string
                  example: "https://s3.../my_profile.png"
                  description: "변경할 프로필 이미지 URL (Presigned URL로 업로드 후 획득)"
      responses:
        '200':
          description: 수정 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_BAD_REQUEST"
                message: "변경할 정보가 없습니다."
        '401':
          description: 인증 실패


  # ---------------- Admin (Mentor) ----------------
  /api/v1/admin/projects/{projectId}/dashboard:
    get:
      summary: 프로젝트별 사용자 제출 현황 (대시보드)
      description: |
        해당 프로젝트의 전체 멤버들의 제출 현황(요약)을 조회합니다.
        (상세 제출 이력은 별도 API로 조회)
      tags:
        - Admin
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectUserDashboardResponse'
        '403':
          description: 권한 없음

  /api/v1/admin/projects/{projectId}/users/{userId}/submissions:
    get:
      summary: 특정 유저의 프로젝트 제출 이력 조회
      description: |
        관리자가 특정 유저의 해당 프로젝트 제출 이력을 상세 조회합니다.
        (대시보드에서 '상세 보기' 클릭 시 사용)
      tags:
        - Admin
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
        - name: userId
          in: path
          required: true
          schema:
            type: string
            description: "조회할 대상 유저의 ID"
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SubmissionSummaryResponse'
        '403':
          description: 권한 없음

  /api/v1/admin/submissions/{submissionId}:
    get:
      summary: 제출 이력 상세 조회 (테스트 케이스 결과)
      description: |
        특정 제출(Submission)의 상세 결과(각 테스트 케이스별 통과 여부 등)를 조회합니다.
        (Admin 전용이므로 Hidden Case 정보도 모두 포함됨)
      tags:
        - Admin
      parameters:
        - name: submissionId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmissionDetailResponse'
        '403':
          description: 권한 없음
        '404':
          description: 제출 기록 없음

  /api/v1/admin/users:
    get:
      summary: 사용자 목록 조회
      description: |
        전체 사용자 또는 특정 기수의 사용자 목록을 조회합니다.
        `generation` 파라미터가 없으면 전체 목록을 반환합니다.
      tags:
        - Admin
      parameters:
        - name: generation
          in: query
          required: false
          description: 조회할 기수 (생략 시 전체 조회)
          schema:
            type: integer
            example: 13
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_UNAUTHORIZED"
                message: "인증이 필요합니다."
        '403':
          description: 권한 없음 (멘토 아님)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "관리자 권한이 없습니다."

  /api/v1/admin/projects:
    get:
      summary: 프로젝트 전체 목록 조회 (대시보드용)
      description: |
        모든 기수의 프로젝트 목록을 조회합니다.
        `generation`, `type` 등으로 필터링하여 관리자 페이지(대시보드)에서 사용합니다.
      tags:
        - Admin
      parameters:
        - name: generation
          in: query
          required: false
          description: 기수 필터 (생략 시 전체)
          schema:
            type: integer
        - name: type
          in: query
          required: false
          description: 언어/프레임워크 필터
          schema:
            type: string
            enum: ["JAVA", "SPRING", "REACT"]
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectSummaryResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_UNAUTHORIZED"
                message: "인증이 필요합니다."
        '403':
          description: 권한 없음 (멘토 아님)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "관리자 권한이 없습니다."

    post:
      summary: 프로젝트 생성
      description: 새로운 프로젝트를 생성합니다. (Admin 전용)
      tags:
        - Admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectCreateRequest'
      responses:
        '201':
          description: 생성 성공
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_BAD_REQUEST"
                message: "필수 파라미터가 누락되었습니다."
        '403':
          description: 권한 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "관리자 권한이 없습니다."

  /api/v1/admin/projects/test-code/parse:
    post:
      summary: 테스트 코드 파싱 및 업로드 (Admin 전용)
      description: |
        테스트 코드 파일(.java 등)을 업로드하여 내부의 테스트 메소드 목록을 추출합니다.
        동시에 파일을 S3에 업로드하고, 저장된 URL을 반환합니다.
        (이 URL과 파싱된 케이스들을 이용해 점수를 배점하고 프로젝트를 생성합니다.)
      tags:
        - Admin
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: "파싱할 테스트 코드 파일 (zip 또는 java)"
      responses:
        '200':
          description: 파싱 및 업로드 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TestCodeParseResponse'
        '400':
          description: 파일 형식 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_INVALID_FILE"
                message: "올바른 java/zip 파일이 아닙니다."

  /api/v1/admin/projects/{id}:
    get:
      summary: 프로젝트 상세 조회 (Admin/Mentor용)
      description: |
        관리자용 프로젝트 상세 조회입니다.
        - `testCodeUrl` (채점 파일) 조회가 가능합니다.
        - `cases`에 숨겨진 케이스(`isHidden=true`)도 모두 포함되며, 구체적인 정보를 확인할 수 있습니다.
        - `generation` 정보가 포함됩니다.
      tags:
        - Admin
      parameters:
        - name: id
          in: path
          required: true
          description: 프로젝트 ID (UUID)
          schema:
            type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectAdminDetailResponse'
        '403':
          description: 권한 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "관리자 권한이 없습니다."
        '404':
          description: 프로젝트 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_PROJECT_NOT_FOUND"
                message: "해당 프로젝트를 찾을 수 없습니다."

    put:
      summary: 프로젝트 수정
      description: 기존 프로젝트 정보를 수정합니다. (Admin 전용)
      tags:
        - Admin
      parameters:
        - name: id
          in: path
          required: true
          description: 프로젝트 ID (UUID)
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectUpdateRequest'
      responses:
        '200':
          description: 수정 성공
        '403':
          description: 권한 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "관리자 권한이 없습니다."
        '404':
          description: 프로젝트 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_PROJECT_NOT_FOUND"
                message: "해당 프로젝트를 찾을 수 없습니다."

    delete:
      summary: 프로젝트 삭제
      description: 프로젝트를 삭제합니다. (Admin 전용)
      tags:
        - Admin
      parameters:
        - name: id
          in: path
          required: true
          description: 프로젝트 ID (UUID)
          schema:
            type: string
      responses:
        '204':
          description: 삭제 성공
        '403':
          description: 권한 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_FORBIDDEN"
                message: "관리자 권한이 없습니다."
        '404':
          description: 프로젝트 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "ERR_PROJECT_NOT_FOUND"
                message: "해당 프로젝트를 찾을 수 없습니다."
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    # ------------- Auth DTOs --------------
    LoginRequest:
      type: object
      required:
        - code
      properties:
        code:
          type: string
          example: "a1b2c3d4e5f6g7h8"
          description: "GitHub OAuth Code"
        inviteCode:
          type: string
          example: "welcome-en-2026"
          description: "(신규 회원일 경우 필수) 초대 코드"

    SignupRequest:
      type: object
      required:
        - registerToken
        - generation
        - name
      properties:
        registerToken:
          type: string
          description: "가입용 임시 토큰 (Login API에서 발급)"
        generation:
          type: integer
          example: 13
          description: "가입 기수"
        name:
          type: string
          example: "홍길동"
          description: "사용자 실명"
        profileImageUrl:
          type: string
          example: "https://avatars.githubusercontent.com/u/123456"
          description: "프로필 이미지 URL (기본값: GitHub 프로필)"

    LoginResponse:
      type: object
      properties:
        accessToken:
          type: string
          example: "eyJhbGciOiJIUzI1NiIsIn..."
          description: JWT Access Token
        refreshToken:
          type: string
          example: "dGhpcyBpcyBhIHJlZnJl..."
          description: Refresh Token

    SignupRequiredResponse:
      type: object
      properties:
        registerToken:
          type: string
          description: "가입 진행을 위한 임시 토큰 (GitHub 인증 완료됨)"
        githubName:
          type: string
          example: "HongGilDong"
          description: "GitHub에서 가져온 기본 이름"
        email:
          type: string
          example: "test@example.com"
        profileImageUrl:
          type: string
          example: "https://avatars.githubusercontent.com/u/123456"
          description: "GitHub 프로필 이미지 URL"

    # ------------- File DTOs --------------
    PresignedUrlRequest:
      type: object
      required:
        - fileName
        - fileType
      properties:
        fileName:
          type: string
          example: "screenshot_MainPage.png"
          description: "업로드할 파일명 (확장자 포함)"
        fileType:
          type: string
          enum: ["IMAGE"]
          example: "IMAGE"
          description: "파일 유형 (IMAGE: 설명용, Markdown 삽입 등)"

    PresignedUrlResponse:
      type: object
      properties:
        presignedUrl:
          type: string
          example: "https://s3.ap-northeast-2.amazonaws.com/bucket/path?signature=..."
          description: "S3 업로드용 Presigned URL (PUT 요청)"
        readUrl:
          type: string
          example: "https://your-bucket-url.com/public/uuid_filename.png"
          description: "업로드 후 참조할 조회용 URL (이미지 src용)"

    # ------------- Admin DTOs --------------
    UserResponse:
      type: object
      properties:
        githubId:
          type: string
          example: "honggildong"
          description: "GitHub ID"
        name:
          type: string
          example: "홍길동"
        generation:
          type: integer
          example: 13
          description: "가입 기수"
        role:
          type: string
          enum: ["MENTOR", "MENTEE"]
          example: "MENTEE"
          description: "사용자 권한"
        profileImageUrl:
          type: string
          example: "https://avatars.githubusercontent.com/u/123456"
          description: "프로필 이미지 URL"

    # ------------- Assignment DTOs --------------

    # ------------- Project DTOs --------------
    ProjectCreateRequest:
      type: object
      required:
        - title
        - type
        - startDate
        - dueDate
        - description
        - generation
        # testCodeUrl is optional or required depending on logic? Assuming required for scoring projects.
      properties:
        title:
          type: string
          example: "로봇 청소기 시뮬레이션"
        type:
          type: string
          enum: ["JAVA", "SPRING", "REACT"]
          example: "JAVA"
        generation:
          type: integer
          example: 13
          description: "대상 기수"
        startDate:
          type: string
          format: date-time
          example: "2026-03-01T00:00:00"
        dueDate:
          type: string
          format: date-time
          example: "2026-03-07T23:59:59"
        description:
          type: string
          format: markdown
          description: 과제 상세 내용 (Markdown)
        skeletonUrl:
          type: string
          example: "https://github.com/en-sharp/skeleton-repo"
        testCodeUrl:
          type: string
          example: "https://s3.bucket.com/testcodes/uuid_test.zip"
          description: "업로드된 테스트 코드 파일 URL (Presigned URL API의 readUrl)"
        scorePolicy:
          $ref: '#/components/schemas/ScorePolicy'

    ProjectUpdateRequest:
      type: object
      properties:
        title:
          type: string
        type:
          type: string
          enum: ["JAVA", "SPRING", "REACT"]
        generation:
          type: integer
        startDate:
          type: string
          format: date-time
        dueDate:
          type: string
          format: date-time
        description:
          type: string
        skeletonUrl:
          type: string
        testCodeUrl:
          type: string
        scorePolicy:
          $ref: '#/components/schemas/ScorePolicy'

    # ProjectResponse removed (Use ProjectSummaryResponse/DetailResponse)

    ScorePolicy:
      type: object
      properties:
        timeLimit:
          type: integer
          description: 시간 제한 (초)
          example: 2
        memoryLimit:
          type: integer
          description: 메모리 제한 (MB)
          example: 128
        cases:
          type: array
          items:
            $ref: '#/components/schemas/Case'

    # ------------- Project DTOs --------------
    ProjectSummaryResponse:
      type: object
      required:
        - id
        - title
        - type
        - startDate
        - dueDate
        - status
      properties:
        id:
          type: string
        dDay:
          type: integer
          example: 3
          description: 제출 기간 D-Day

    ProjectDetailResponse:
      allOf:
        - $ref: '#/components/schemas/ProjectSummaryResponse'
        - type: object
          properties:
            description:
              type: string
              description: project 내용 (Markdown)
              example: |
                # [구현] 로봇 청소기 시뮬레이션
                ## 문제 설명
                ...
            skeletonUrl:
              type: string
              example: "https://github.com/username/en#"
              description: Project skeletonCode repo url
            scorePolicy:
              $ref: '#/components/schemas/ScorePolicy'
    
    ProjectAdminDetailResponse:
      allOf:
        - $ref: '#/components/schemas/ProjectDetailResponse'
        - type: object
          properties:
            testCodeUrl:
              type: string
              description: "채점용 테스트 코드 파일 URL"
              example: "https://s3.../test.zip"
            # generation is already in Summary, cases are in scorePolicy
            # Admin can see hidden cases in scorePolicy.cases

    Case:
      type: object
      required:
        - id
        - name
        - score
        - isHidden
      properties:
        id:
          type: string
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          description: case ID
        name:
          type: string
          example: "삭제 테스트"
          description: "case 이름 (비공개 Case의 경우 Public API에서는 '비공개 테스트'로 마스킹됨)"
        score:
          type: integer
          example: 25
          description: 해당 case 배점
        isHidden:
          type: boolean
          example: true
          description: "case 숨김 여부 (True일 경우, Public API에서는 상세 정보가 마스킹 처리됨)"

    TestCodeParseResponse:
      type: object
      properties:
        testCodeUrl:
          type: string
          example: "https://s3.../uuid_testcode.zip"
          description: "업로드된 테스트 코드 파일 URL (Project Create 시 사용)"
        testCases:
          type: array
          description: "파싱된 테스트 케이스(메소드) 이름 목록"
          items:
            type: string
            example: "testLoginSuccess"

    SubmitRequest:
      type: object
      required:
        - projectId
        - repoUrl
      properties:
        projectId:
          type: string
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          description: 제출할 프로젝트 ID (UUID)
        repoUrl:
          type: string
          example: "https://github.com/username/repository"
          description: 제출할 GitHub Repository URL


    # ------------- Error Response --------------
    ErrorResponse:
      type: object
      properties:
        code:
          type: string
          example: "ERR_ALREADY_RESERVED"
        message:
          type: string
          example: "해당 시간대에는 이미 예약이 존재합니다."

    # ------------- Submission DTOs --------------
    SubmissionSummaryResponse:
      type: object
      required:
        - id
        - score
        - status
        - submitAt
      properties:
        id:
          type: string
          example: "a1b2c3d4-..."
          description: "제출 ID"
        score:
          type: integer
          example: 85
        status:
          type: string
          enum: ["PASS", "FAIL", "ERROR"]
          example: "FAIL"
          description: "채점 결과 (100점: PASS, 그 외: FAIL/ERROR)"
        submitAt:
          type: string
          format: date-time
          example: "2026-03-01T12:00:00"

    ProjectUserDashboardResponse:
      type: object
      properties:
        userId:
          type: string
          example: "hong-user-id"
        name:
          type: string
          example: "홍길동"
        profileImageUrl:
          type: string
          example: "https://avatars.githubusercontent.com/u/123456"
        status:
          type: string
          enum: ["PASS", "FAIL", "NOT_SUBMITTED"]
          example: "PASS"
          description: "사용자 최종 상태 (100점 달성 시 PASS)"
        maxScore:
          type: integer
          example: 100
        submitCount:
          type: integer
          example: 5
        lastSubmittedAt:
          type: string
          format: date-time

    SubmissionDetailResponse:
      allOf:
        - $ref: '#/components/schemas/SubmissionSummaryResponse'
        - type: object
          properties:
            repoUrl:
              type: string
              example: "https://github.com/username/repository"
              description: "제출한 GitHub Repository URL"
            cases:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: "Case ID"
                  name:
                    type: string
                  status:
                    type: string
                    enum: ["PASS", "FAIL"]
                  timeUsage:
                    type: integer
                    description: "소요 시간 (ms)"
                  memoryUsage:
                    type: integer
                    description: "메모리 사용량 (MB)"
            

